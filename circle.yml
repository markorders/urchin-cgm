machine:
  python:
    version: 2.7.12
  node:
    version: 0.12.0
  environment:
    PEBBLE_TOOL: 4.3
    PEBBLE_SDK: 3.14
  post:
    - npm install -g npm@3.x.x

dependencies:
  pre:
    - . test/ensure-pebble-test-environment.sh
  override:
    - echo "Skipping npm install for now"
  cache_directories:
    - ~/.pebble-sdk
    - ~/pebble-dev
    - ~/imagemagick

test:
  pre:
    - mkdir -p $CIRCLE_TEST_REPORTS/js-unit-tests
    - mkdir -p $CIRCLE_TEST_REPORTS/screenshots
  override:
    - . ~/pebble-dev/path.sh; pebble build
  post:
    - mkdir -p $CIRCLE_ARTIFACTS/build && cp release/urchin-cgm.pbw $CIRCLE_ARTIFACTS/build/ || true
